db:
  container_name: db
  image: ckan/postgresql
  # ports:
  #   - "5432:5432"
solr:
  container_name: solr
  image: quay.io/ukhomeofficedigital/ckan-solr:v0.1.0
  # ports:
  #   - "8983:8983"
mailcatcher:
  container_name: mailcatcher
  image: helder/mailcatcher
  ports:
    - "8080:80"
ckan:
  container_name: ckan
  build: .
  environment:
     - CKAN_SMTP_SERVER=mailcatcher:25
  ports:
    - "5000:5000"
  links:
    - solr:solr
    - db:db
    - mailcatcher:mailcatcher
proxy:
  container_name: proxy
  image: quay.io/ukhomeofficedigital/nginx-proxy:v1.1.6
  environment:
    - PROXY_SERVICE_HOST=https://172.17.0.5
    - PROXY_SERVICE_PORT=5000
    - NAXSI_USE_DEFAULT_RULES=FALSE
    - ENABLE_UUID_PARAM=FALSE
  ports:
    - "443:443"
    - "80:80"
  links:
    - ckan:ckan
